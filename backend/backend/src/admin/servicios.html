<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Servicios - Pelucan</title>
<style>
  body {
    font-family: "Inter", Arial, sans-serif;
    background: #f5f7fb;
    margin: 0;
    padding: 30px;
    color: #333;
  }

  h2 {
    text-align: center;
    margin-bottom: 25px;
    color: #333;
    font-weight: 700;
    letter-spacing: -0.5px;
  }

  /* Botones */
  button {
    background: #4a7dfc;
    border: none;
    padding: 10px 18px;
    color: white;
    border-radius: 8px;
    cursor: pointer;
    font-size: 15px;
    transition: 0.2s;
  }

  button:hover {
    background: #2e63e6;
  }

  button:last-child {
    background: #777;
  }

  button:last-child:hover {
    background: #555;
  }

  /* Contenedor del formulario */
  #formServicio {
    margin: 20px auto;
    max-width: 450px;
    padding: 20px;
    display: none;
    background: rgba(255, 255, 255, 0.85);
    backdrop-filter: blur(5px);
    border-radius: 12px;
    box-shadow: 0 5px 18px rgba(0,0,0,0.1);
  }

  #formServicio input {
    width: 100%;
    margin: 10px 0;
    padding: 12px;
    border-radius: 8px;
    border: 1px solid #ccc;
    transition: 0.2s;
  }

  #formServicio input:focus {
    border-color: #4a7dfc;
    outline: none;
    box-shadow: 0 0 0 3px rgba(74, 125, 252, 0.25);
  }

  /* TABLA */
  table {
    width: 100%;
    margin-top: 25px;
    border-collapse: collapse;
    overflow: hidden;
    border-radius: 10px;
    box-shadow: 0 5px 20px rgba(0,0,0,0.1);
  }

  thead {
    background: #4a7dfc;
    color: white;
  }

  th, td {
    padding: 12px;
    text-align: center;
  }

  tbody tr:nth-child(even) {
    background: #f0f4ff;
  }

  tbody tr:hover {
    background: #e4ebff;
  }

  .acciones button {
    margin: 0 5px;
  }

  /* MODAL (ya preparado por si lo necesit√°s luego) */
  .modal {
    display: none;
    position: fixed;
    z-index: 999;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    background: rgba(0,0,0,0.55);
    backdrop-filter: blur(3px);
  }

  .modal-content {
    background: white;
    max-width: 500px;
    margin: 10% auto;
    padding: 25px;
    border-radius: 14px;
    box-shadow: 0 5px 25px rgba(0,0,0,0.2);
    animation: fadeIn 0.25s ease;
  }

  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(-20px); }
    to { opacity: 1; transform: translateY(0); }
  }
</style>

</head>
<body>

<h2>Gesti√≥n de Servicios</h2>

<button onclick="mostrarFormulario()">Agregar Servicio</button>
<button onclick="window.history.back()">‚¨ÖÔ∏è Volver</button>

<form id="formServicio">
  <input type="hidden" id="id">
  <input type="text" id="nombre" placeholder="Nombre del Servicio" required>
  <input type="number" id="precio" placeholder="Precio" required>
  <input type="number" id="duracion" placeholder="Duraci√≥n (minutos)" required>
  <button type="submit">Guardar</button>
  <button type="button" onclick="ocultarFormulario()">Cancelar</button>
</form>

<table id="tablaServicios">
  <thead>
    <tr>
      <th>ID</th>
      <th>Nombre</th>
      <th>Precio</th>
      <th>Duraci√≥n</th>
      <th>Acciones</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>

<script>
const API = "http://localhost:3000/servicios";
const form = document.getElementById("formServicio");
const tbody = document.querySelector("#tablaServicios tbody");

function mostrarFormulario() { form.style.display = "block"; }
function ocultarFormulario() { form.style.display = "none"; form.reset(); }

async function cargarServicios() {
  const res = await fetch(API);
  const data = await res.json();
  tbody.innerHTML = "";
  data.forEach(s => {
    tbody.innerHTML += `
      <tr>
        <td>${s.id}</td>
        <td>${s.nombre}</td>
        <td>${s.precio}</td>
        <td>${s.duracion}</td>
        <td>
          <button onclick="editar(${s.id}, '${s.nombre}', ${s.precio}, ${s.duracion})">‚úèÔ∏è</button>
          <button onclick="eliminar(${s.id})">üóëÔ∏è</button>
        </td>
      </tr>`;
  });
}

function editar(id, nombre, precio, duracion) {
  mostrarFormulario();
  document.getElementById("id").value = id;
  document.getElementById("nombre").value = nombre;
  document.getElementById("precio").value = precio;
  document.getElementById("duracion").value = duracion;
}

async function eliminar(id) {
  if (confirm("¬øEliminar servicio?")) {
    await fetch(`${API}/${id}`, { method: "DELETE" });
    cargarServicios();
  }
}

form.addEventListener("submit", async (e) => {
  e.preventDefault();
  const id = document.getElementById("id").value;
  const datos = {
    nombre: document.getElementById("nombre").value,
    precio: Number(document.getElementById("precio").value),
    duracion: Number(document.getElementById("duracion").value)
  };
  if (id) {
    await fetch(`${API}/${id}`, { method: "PUT", headers: {"Content-Type":"application/json"}, body: JSON.stringify(datos) });
  } else {
    await fetch(API, { method: "POST", headers: {"Content-Type":"application/json"}, body: JSON.stringify(datos) });
  }
  ocultarFormulario();
  cargarServicios();
});

cargarServicios();
</script>
</body>
</html>
